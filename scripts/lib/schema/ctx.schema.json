{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Context Engineering Schema v1.0",
  "description": "Schema for snapctx-sh generated context files - ensuring high signal, low token context for LLMs",
  "type": "array",
  "minItems": 1,
  "items": {
    "$ref": "#/definitions/contextNode"
  },
  "definitions": {
    "contextNode": {
      "type": "object",
      "required": ["type", "name"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["directory", "file"],
          "description": "Node type for hierarchical context structure"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Absolute or relative path to the node"
        },
        "contents": {
          "type": "array",
          "description": "Child nodes for directories (recursive structure)",
          "items": {
            "$ref": "#/definitions/contextNode"
          }
        },
        "metadata": {
          "type": "object",
          "description": "Optional metadata for enhanced context engineering",
          "properties": {
            "size": {
              "type": "integer",
              "minimum": 0,
              "description": "File size in bytes"
            },
            "lines": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of lines for text files"
            },
            "language": {
              "type": "string",
              "description": "Programming language detected"
            },
            "modified": {
              "type": "string",
              "format": "date-time",
              "description": "Last modification timestamp"
            },
            "significance": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Context significance score (0-1)"
            }
          }
        }
      },
      "allOf": [
        {
          "if": {
            "properties": { "type": { "const": "directory" } }
          },
          "then": {
            "required": ["contents"]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "file" } }
          },
          "then": {
            "not": {
              "required": ["contents"]
            }
          }
        }
      ]
    }
  },
  "_context_engineering_meta": {
    "version": "1.0.0",
    "philosophy": "Context > Parameters",
    "principles": [
      "High signal, low token",
      "Automated freshness",
      "Layered fidelity",
      "Explainability first",
      "Fail gracefully"
    ],
    "validation_rules": {
      "max_depth": 10,
      "min_signal_ratio": 0.7,
      "preferred_token_budget": 32768
    }
  }
} 